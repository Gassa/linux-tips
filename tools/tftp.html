
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>network-boot Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../cloud/" />
    
    
    <link rel="prev" href="benchmark.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../grub/">
            
                <a href="../grub/">
            
                    
                    grub
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../grub/timeout_setting.html">
            
                <a href="../grub/timeout_setting.html">
            
                    
                    timeout setting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../led/">
            
                <a href="../led/">
            
                    
                    LED
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../button/">
            
                <a href="../button/">
            
                    
                    button
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../linux_kernel_compile/">
            
                <a href="../linux_kernel_compile/">
            
                    
                    linux kernel
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../linux_kernel_compile/compile_setting.html">
            
                <a href="../linux_kernel_compile/compile_setting.html">
            
                    
                    compile setting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../linux_kernel_compile/how_to_compile.html">
            
                <a href="../linux_kernel_compile/how_to_compile.html">
            
                    
                    How to compile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../linux_kernel_compile/difference_of_kernel_format.html">
            
                <a href="../linux_kernel_compile/difference_of_kernel_format.html">
            
                    
                    Difference of kernel format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="backup.html">
            
                <a href="backup.html">
            
                    
                    backup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="scripts.html">
            
                <a href="scripts.html">
            
                    
                    Scripts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="benchmark.html">
            
                <a href="benchmark.html">
            
                    
                    benchmark
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.4" data-path="tftp.html">
            
                <a href="tftp.html">
            
                    
                    network-boot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../cloud/">
            
                <a href="../cloud/">
            
                    
                    Cloud
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../cloud/amzon_ec2.html">
            
                <a href="../cloud/amzon_ec2.html">
            
                    
                    Amzon EC2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="../cloud/basic.html">
            
                <a href="../cloud/basic.html">
            
                    
                    basic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../u-boot/">
            
                <a href="../u-boot/">
            
                    
                    U-Boot
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../u-boot/introduction.html">
            
                <a href="../u-boot/introduction.html">
            
                    
                    introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../u-boot/uenv.html">
            
                <a href="../u-boot/uenv.html">
            
                    
                    uEnv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../u-boot/references.html">
            
                <a href="../u-boot/references.html">
            
                    
                    references
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../git/">
            
                <a href="../git/">
            
                    
                    Git
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../git/getting-started.html">
            
                <a href="../git/getting-started.html">
            
                    
                    Getting started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../git/getting-a-git-repository.html">
            
                <a href="../git/getting-a-git-repository.html">
            
                    
                    Getting a Git Repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../git/basic-usage.html">
            
                <a href="../git/basic-usage.html">
            
                    
                    Basic usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../git/branching.html">
            
                <a href="../git/branching.html">
            
                    
                    Branching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../git/working-with-remotes.html">
            
                <a href="../git/working-with-remotes.html">
            
                    
                    Working with Remotes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../git/merging.html">
            
                <a href="../git/merging.html">
            
                    
                    Merging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../git/git_merge_tool.html">
            
                <a href="../git/git_merge_tool.html">
            
                    
                    git merge tool
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../git/workflow-of-git.html">
            
                <a href="../git/workflow-of-git.html">
            
                    
                    workflow of git
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../network/">
            
                <a href="../network/">
            
                    
                    Network
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../network/multiple_gateway.html">
            
                <a href="../network/multiple_gateway.html">
            
                    
                    multiple gateways
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../os/">
            
                <a href="../os/">
            
                    
                    OS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../os/arch.html">
            
                <a href="../os/arch.html">
            
                    
                    ARCH
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../file/">
            
                <a href="../file/">
            
                    
                    File
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../file/mount_img.html">
            
                <a href="../file/mount_img.html">
            
                    
                    Moung IMG File
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >network-boot</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="beaglebone-black-network-boot">Beaglebone Black Network Boot</h1>
<h2 id="tftp-introduction-installation">TFTP introduction, installation</h2>
<p>TFTP is a popular method of booting IP phones, routers, and net boot capable PCs. It provides a simple way to download files to clients. TFTP requires a server to be running somewhere on the network, though.</p>
<p>I will use <code>tftp-hpa</code> here.
if you have not installed it,</p>
<p>run <code>sudo apt-get install tftp-hpa tftpd-hpa</code> if you are using debian beased linux distribution</p>
<h2 id="configuration">Configuration</h2>
<h3 id="set-path-for-tftp">set path for TFTP</h3>
<p><code>sudo nano /etc/default/tftpd-hpa</code></p>
<pre><code class="lang-sh"><span class="hljs-comment"># /etc/default/tftpd-hpa</span>
TFTP_USERNAME=&#x201D;tftp&#x201D;
TFTP_DIRECTORY=&#x201D;/home/USERNAME/rootfs&#x201D;
TFTP_ADDRESS=&#x201D;0.0.0.0:69&#x2033;
TFTP_OPTIONS=&#x201D;&#x2013;secure&#x201D;
</code></pre>
<h3 id="set-path-permission">set path permission</h3>
<p>We need to change the ownership, and permissions for the NFS share directory so TFTP can do its job properly.</p>
<pre><code class="lang-sh">sudo chown nobody\: /home/USERNAME/rootfs
sudo chmod 777 /home/USERNAME/rootfs
</code></pre>
<h2 id="tftp-service-test">TFTP service test</h2>
<pre><code class="lang-sh">sudo service tftpd-hpa restart
<span class="hljs-built_in">cd</span> ~
tftp 127.0.0.1
</code></pre>
<p>Do make sure to issue the command cd <code>~</code> to properly test TFTP.</p>
<pre><code class="lang-sh">&gt;get /boot/am335x-boneblack.dtb
&gt;quit
ls
</code></pre>
<p>make sure am335x-boneblack.dtb exist in current working directory. Then remove am335x-boneblack.dtb.</p>
<pre><code class="lang-sh">rm am335x-boneblack.dtb
</code></pre>
<h2 id="beaglebone-black-&#x2013;-uenvtxt">Beaglebone Black &#x2013; uEnv.txt</h2>
<p>show my version first.</p>
<pre><code class="lang-sh"><span class="hljs-comment">#uEnv.txt boot kernel from TFTP, NFS or SD</span>

<span class="hljs-comment">#basic setting for booting from tftp</span>
ipaddr=192.168.8.10
serverip=192.168.8.1
gatewayip=192.168.8.254
staticip=<span class="hljs-variable">${ipaddr}</span>:<span class="hljs-variable">${serverip}</span>:<span class="hljs-variable">${gatewayip}</span>:255.255.255.0:::off

<span class="hljs-comment">#setting for kernel loading</span>
kloadaddr=0x82000000
fdtaddr=0x83000000

<span class="hljs-comment">##Disable HDMI/eMMC</span>
cape_<span class="hljs-built_in">disable</span>=capemgr.disable_partno=BB-BONELT-HDMI,BB-BONELT-HDMIN,BB-BONE-EMMC-2G
<span class="hljs-comment">#cape_enable=capemgr.enable_partno=pru-enable</span>

<span class="hljs-comment">#parameters for kernel</span>
mmc_args=setenv bootargs console=ttyO0,115200n8 quiet root=/dev/mmcblk0p2 ro rootfstype=ext4 rootwait <span class="hljs-variable">${cape_disable}</span> <span class="hljs-variable">${cape_enable}</span>
nfs_args=setenv bootargs console=ttyO0,115200n8 root=/dev/nfs rw nfsroot=<span class="hljs-variable">${serverip}</span>:<span class="hljs-variable">${rootpath}</span> ip=<span class="hljs-variable">${staticip}</span> <span class="hljs-variable">${cape_disable}</span> <span class="hljs-variable">${cape_enable}</span>


<span class="hljs-comment">#load kernel and device tree</span>
load_u_kernel=tftpboot <span class="hljs-variable">${kloadaddr}</span> /boot/uImage
load_z_kernel=tftpboot <span class="hljs-variable">${kloadaddr}</span> /boot/zImage
loadfdt=tftpboot <span class="hljs-variable">${fdtaddr}</span>  /boot/dtbs/am335x-boneblack.dtb


<span class="hljs-comment">#booting options</span>
boot_uImage=bootm <span class="hljs-variable">${kloadaddr}</span> - <span class="hljs-variable">${fdtaddr}</span>
boot_zimage=bootz <span class="hljs-variable">${kloadaddr}</span> - <span class="hljs-variable">${fdtaddr}</span>

<span class="hljs-comment">#to boot</span>
uenvcmd=run load_u_kernel; run loadfdt; run mmc_args; run boot_uImage

<span class="hljs-comment">#uenvcmd=run load_z_kernel; run loadfdt; run mmc_args; run boot_zimage</span>
</code></pre>
<h4 id="demo-here">demo here:</h4>
<pre><code class="lang-sh">bootdelay=1
ipaddr=xxx.xxx.xxx.xxx
serverip=xxx.xxx.xxx.xxx
static_ip=xxx.xxx.xxx.xxx:xxx.xxx.xxx.xxx:xxx.xxx.xxx.xxx:255.255.255.0:arm
rootpath=/home/username/rootfs,rsize=16384,wsize=16384
console=ttyO0,115200n8
loadtftp=tftpboot 0x80200000 /boot/uImage; tftpboot 0x815f0000 /boot/am335x-boneblack.dtb
netargs=setenv bootargs console=<span class="hljs-variable">${console}</span> <span class="hljs-variable">${optargs}</span> root=/dev/nfs nfsroot=<span class="hljs-variable">${serverip}</span>:<span class="hljs-variable">${rootpath}</span>,vers=3 rw ip=<span class="hljs-variable">${static_ip}</span>
uenvcmd=setenv <span class="hljs-built_in">autoload</span> no; run loadtftp; run netargs; bootm 0x80200000 &#x2013; 0x815f0000
</code></pre>
<h4 id="detail-here">detail here:</h4>
<pre><code class="lang-sh">bootdelay=1
ipaddr=xxx.xxx.xxx.xxx
serverip=xxx.xxx.xxx.xxx
</code></pre>
<p>Technically <code>bootdelay=1</code> is not needed. <code>ipaddr=xxx.xxx.xxx.xxx</code>, and <code>serverip=xxx.xxx.xxx.xxx</code> are needed so uboot knows where to look for the Linux image, and device tree blob for the Beaglebone Black. If these parameters are omitted, the Beaglebone Black will hang with 3 USR LEDs lit solid shortly after starting the boot process.</p>
<pre><code class="lang-sh">static_ip=xxx.xxx.xxx.xxx:xxx.xxx.xxx.xxx:xxx.xxx.xxx.xxx:255.255.255.0:arm
</code></pre>
<p>Translates to:</p>
<pre><code class="lang-sh">static_ip=ipaddr:serverip:gatewayip:netmask:hostname
</code></pre>
<p>All of these parameters with the exception of hostname are necessary with <code>uEnv.txt</code> in its current configuration. This lets uboot know where to find the /root file system. Or more correctly, these parameters are passed to the kernel through <code>${optargs}</code>.</p>
<h3 id="reference">reference</h3>
<p><a href="http://wiki.beyondlogic.org/index.php/BeagleBoneBlack_Building_Kernel" target="_blank">http://wiki.beyondlogic.org/index.php/BeagleBoneBlack_Building_Kernel</a></p>
<p><a href="http://www.embeddedhobbyist.com/2013/06/beaglebone-black-network-boot/" target="_blank">http://www.embeddedhobbyist.com/2013/06/beaglebone-black-network-boot/</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="benchmark.html" class="navigation navigation-prev " aria-label="Previous page: benchmark">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../cloud/" class="navigation navigation-next " aria-label="Next page: Cloud">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"network-boot","level":"1.6.4","depth":2,"next":{"title":"Cloud","level":"1.7","depth":1,"path":"cloud/README.md","ref":"cloud/README.md","articles":[{"title":"Amzon EC2","level":"1.7.1","depth":2,"path":"cloud/amzon_ec2.md","ref":"cloud/amzon_ec2.md","articles":[{"title":"basic","level":"1.7.1.1","depth":3,"path":"cloud/basic.md","ref":"cloud/basic.md","articles":[]}]}]},"previous":{"title":"benchmark","level":"1.6.3","depth":2,"path":"tools/benchmark.md","ref":"tools/benchmark.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"tools/tftp.md","mtime":"2017-03-23T11:27:07.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-23T11:37:54.613Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

